<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recurrence Networks • casnet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Recurrence Networks">
<meta property="og:description" content="casnet">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">casnet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CRQA.html">Recurrence Quantification Analysis</a>
    </li>
    <li>
      <a href="../articles/DynamicComplexity.html">Dynamic Complexity as an Early-Warning Indicator for Clinical Change</a>
    </li>
    <li>
      <a href="../articles/RecurrenceNetworks.html">Recurrence Networks</a>
    </li>
    <li>
      <a href="../articles/scalingphenomena.html">Quantifying Scaling Phenomena in Time Series</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FredHasselman/casnet/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Recurrence Networks</h1>
                        <h4 data-toc-skip class="author">Fred
Hasselman</h4>
            
            <h4 data-toc-skip class="date">2022-03-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/FredHasselman/casnet/blob/HEAD/vignettes/RecurrenceNetworks.Rmd" class="external-link"><code>vignettes/RecurrenceNetworks.Rmd</code></a></small>
      <div class="hidden name"><code>RecurrenceNetworks.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="recurrence-networks">
<em>Recurrence Networks</em><a class="anchor" aria-label="anchor" href="#recurrence-networks"></a>
</h2>
<p>Recurrence networks are graphs created from a recurrence matrix. This
means the nodes (vertices) of the graph represent values observed at
specific time points and the connections (edges) between nodes represent
a recurrence relation between the values observed at those time points.
In a reconstructed or multidimensional (coarse grained) state space, the
values represent some measure of distance between the observed states
(coordinates in state space).</p>
<p>We can turn the recurrence matrix into an adjacency matrix, e.g. an
<code>igraph</code> object in <code>R</code>. This means we can use all
the <code>igraph</code> functions to calculate network measures. The
main differences between the recurrence matrix as used for (C)RQA and
the adjacency matrix is that the latter can represent weighted, as well
as directed recurrence networks. The interpretation of the network
measures calculated from a recurrence network is somewhat different from
when the nodes do not represent time. The ultimate reference for
learning about recurrence networks is:</p>
<blockquote>
<p><a href="https://www.sciencedirect.com/science/article/abs/pii/S037015731830276X?via%3Dihub" class="external-link">Zou,
Y., Donner, R. V., Marwan, N., Donges, J. F., &amp; Kurths, J. (2018).
Complex network approaches to nonlinear time series analysis. Physics
Reports</a></p>
</blockquote>
<p>Package <code>casnet</code> has some functions to create recurrence
networks, they are similar to the functions used for CRQA: *
<code><a href="../reference/rn.html">rn()</a></code> is very similar to <code><a href="../reference/rp.html">rp()</a></code>, it will create a
matrix based on embedding parameters, or on a multivariate dataset. One
difference is the option to create a weighted and/or directed matrix.
This is a matrix in which non-recurring values are set to 0, but the
recurring values are not replaced by a 1, the distance value (or
recurrence time) is retained and acts as an edge-weight *
<code><a href="../reference/rn_plot.html">rn_plot()</a></code> will produce similar plots as
<code><a href="../reference/rp_plot.html">rp_plot()</a></code>, with some differences for weighted and directed
networks * <code><a href="../reference/rn_measures.html">rn_measures()</a></code> produces several common network
measures used with recurrence networks.</p>
<div class="section level4">
<h4 class="unnumbered" id="esm-data">ESM data<a class="anchor" aria-label="anchor" href="#esm-data"></a>
</h4>
<p>We’ll use the same dataset as in the vignette <a href="https://fredhasselman.com/casnet/articles/dynamiccomplexity.html" class="external-link"><em>Dynamic
Complexity</em></a> by Bastiaansen et al. (2019). Load it from the Open
Science Framework, or use the internal data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/FredHasselman/casnet" class="external-link">casnet</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/FredHasselman/invctr" class="external-link">invctr</a></span><span class="op">)</span>
<span class="co"># # Load data from OSF https://osf.io/tcnpd/</span>
<span class="co"># require(osfr)</span>
<span class="co"># manyAnalystsESM &lt;- rio::import(osfr::osf_download(osfr::osf_retrieve_file("tcnpd") , overwrite = TRUE)$local_path)</span>

<span class="co"># Or use the internal data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">manyAnalystsESM</span><span class="op">)</span></code></pre></div>
<p>A visual inspection of the data reveals some variables can be omitted
and cases with missing values need to be imputed or removed. We’ll use
the same strategy as explained in the <a href="https://fredhasselman.com/casnet/articles/dynamiccomplexity.html" class="external-link"><em>Dynamic
Complexity</em></a> vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org" class="external-link">igraph</a></span><span class="op">)</span>

<span class="fu"><a href="../reference/plotTS_multi.html">plotTS_multi</a></span><span class="op">(</span><span class="va">manyAnalystsESM</span>, subtitle <span class="op">=</span> <span class="st">"Raw data"</span><span class="op">)</span></code></pre></div>
<p><img src="RecurrenceNetworks_files/figure-html/imputeNA-1.png" width="504" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Use the date information in the dataset to create time series objects</span>
<span class="va">dates</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strptime</a></span><span class="op">(</span><span class="va">manyAnalystsESM</span><span class="op">$</span><span class="va">start</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">manyAnalystsESM</span><span class="op">$</span><span class="va">start</span><span class="op">)</span><span class="op">]</span>, <span class="st">"%m/%d/%Y %H:%M"</span><span class="op">)</span>, <span class="st">"%d-%m-%Y\n%H:%M"</span><span class="op">)</span>
<span class="va">weeknum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strptime</a></span><span class="op">(</span><span class="va">manyAnalystsESM</span><span class="op">$</span><span class="va">start</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">manyAnalystsESM</span><span class="op">$</span><span class="va">start</span><span class="op">)</span><span class="op">]</span>, <span class="st">"%m/%d/%Y %H:%M"</span><span class="op">)</span>,format <span class="op">=</span> <span class="st">"%V"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># days       &lt;- format(strptime(dates, "%m/%d/%Y %H:%M"), "%d-%m-%Y")</span>
<span class="co"># time       &lt;- format(strptime(dates, "%m/%d/%Y %H:%M"), "%H:%M")</span>

<span class="co"># Don't use columns 1, 26-28, 30-35</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">manyAnalystsESM</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">26</span><span class="op">:</span><span class="fl">28</span>, <span class="fl">30</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span><span class="op">]</span>

<span class="co"># 1. Remove NA </span>
<span class="va">out.NA</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,<span class="op">]</span>

<span class="co"># 2. Classification And Regression Trees / Random Forests</span>
<span class="va">imp.cart</span>  <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span><span class="va">df</span>, method <span class="op">=</span> <span class="st">'cart'</span>, printFlag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">out.cart</span>  <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/complete.mids.html" class="external-link">complete</a></span><span class="op">(</span><span class="va">imp.cart</span><span class="op">)</span>

<span class="va">out.cart</span><span class="op">$</span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="va">dates</span>
<span class="fu"><a href="../reference/plotTS_multi.html">plotTS_multi</a></span><span class="op">(</span><span class="va">out.cart</span>, subtitle <span class="op">=</span> <span class="st">"Imputed data"</span>, timeVec <span class="op">=</span> <span class="st">"dates"</span><span class="op"><a href="https://rdrr.io/pkg/invctr/man/fINDexers.html" class="external-link">%ci%</a></span><span class="va">out.cart</span><span class="op">)</span></code></pre></div>
<p><img src="RecurrenceNetworks_files/figure-html/imputeNA-2.png" width="504" style="display: block; margin: auto;"></p>
<p>The first step is to create a recurrence matrix and consider it an
adjacency matrix. This matrix can be created based on the reconstructed
state space using the method of delay embedding, or, on a
multidimensional state space in which the dimensions are a (subset) of
the multivariate time series.</p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="reconstructed-state-space">
<strong>Reconstructed State Space</strong><a class="anchor" aria-label="anchor" href="#reconstructed-state-space"></a>
</h3>
<p>Below is an example of how to create a recurrence network based on a
reconstructed state space. We’ll examine the variables
<code>restless</code> and <code>procrast</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#----------------------</span>
<span class="co"># Adjacency matrix </span>
<span class="co">#----------------------</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/FredHasselman/casnet" class="external-link">casnet</a></span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_parameters.html">est_parameters</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">out.cart</span><span class="op">$</span><span class="va">restless</span><span class="op">)</span></code></pre></div>
<p><img src="RecurrenceNetworks_files/figure-html/unnamed-chunk-3-1.png" width="504" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_parameters.html">est_parameters</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">out.cart</span><span class="op">$</span><span class="va">procrast</span><span class="op">)</span></code></pre></div>
<p><img src="RecurrenceNetworks_files/figure-html/unnamed-chunk-3-2.png" width="504" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># By passing emRad = NA, a radius will be calculated based on 5% recurrence</span>
<span class="va">RN1</span> <span class="op">&lt;-</span> <span class="fu">casnet</span><span class="fu">::</span><span class="fu"><a href="../reference/rn.html">rn</a></span><span class="op">(</span>y1 <span class="op">=</span> <span class="va">out.cart</span><span class="op">$</span><span class="va">restless</span>, emDim <span class="op">=</span> <span class="va">p1</span><span class="op">$</span><span class="va">optimDim</span>, emLag <span class="op">=</span> <span class="va">p1</span><span class="op">$</span><span class="va">optimLag</span>, emRad <span class="op">=</span> <span class="cn">NA</span>, targetValue <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="fu">casnet</span><span class="fu">::</span><span class="fu"><a href="../reference/rn_plot.html">rn_plot</a></span><span class="op">(</span><span class="va">RN1</span><span class="op">)</span></code></pre></div>
<p><img src="RecurrenceNetworks_files/figure-html/unnamed-chunk-3-3.png" width="504" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RQA measures</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>rqa1 <span class="ot">&lt;-</span> casnet<span class="sc">::</span><span class="fu">rp_measures</span>(RN1, <span class="at">silent =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">~~~</span>o<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~</span>casnet<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~~</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  Global Measures</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   Global Max.points N.points     RR Singular Divergence Repetitiveness</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span> Matrix      <span class="dv">14161</span>      <span class="dv">691</span> <span class="fl">0.0488</span>      <span class="dv">528</span>     <span class="fl">0.0084</span>            <span class="fl">1.4</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  Line<span class="sc">-</span>based Measures</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>        Lines N.lines N.points Measure  Rate Mean Max.   ENT ENT_rel  CoV</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span>   Diagonal      <span class="dv">23</span>      <span class="dv">163</span>     DET <span class="fl">0.236</span> <span class="fl">7.09</span>  <span class="dv">119</span> <span class="fl">0.179</span>  <span class="fl">0.0374</span> <span class="fl">3.44</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">2</span>   Vertical      <span class="dv">54</span>      <span class="dv">114</span>   V LAM <span class="fl">0.165</span> <span class="fl">2.11</span>    <span class="dv">3</span> <span class="fl">0.349</span>  <span class="fl">0.0730</span> <span class="fl">0.15</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">3</span> Horizontal      <span class="dv">54</span>      <span class="dv">114</span>   H LAM <span class="fl">0.165</span> <span class="fl">2.11</span>    <span class="dv">3</span> <span class="fl">0.349</span>  <span class="fl">0.0730</span> <span class="fl">0.15</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">4</span>  V<span class="sc">+</span>H Total     <span class="dv">108</span>      <span class="dv">228</span> V<span class="sc">+</span>H LAM <span class="fl">0.165</span> <span class="fl">2.11</span>    <span class="dv">3</span> <span class="fl">0.349</span>  <span class="fl">0.0730</span> <span class="fl">0.15</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">~~~</span>o<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~</span>casnet<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~~</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create RN graph</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>g1  <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(RN1, <span class="at">mode=</span><span class="st">"undirected"</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">V</span>(g1)<span class="sc">$</span>size <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g1)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>g1r <span class="ot">&lt;-</span> casnet<span class="sc">::</span><span class="fu">make_spiral_graph</span>(g1, </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">markEpochsBy =</span> weeknum[<span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(g1)], </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">markTimeBy =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="RecurrenceNetworks_files/figure-html/unnamed-chunk-3-4.png" width="504" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RN measures</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>rn1 <span class="ot">&lt;-</span> <span class="fu">rn_measures</span>(g1, <span class="at">silent =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">~~~</span>o<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~</span>casnet<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~~</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Global Network Measures</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   EdgeDensity MeanStrengthDensity GlobalClustering NetworkTransitivity</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span>  <span class="fl">0.04073494</span>                  <span class="cn">NA</span>        <span class="fl">0.4754514</span>           <span class="fl">0.6108374</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   AveragePathLength GlobalEfficiency</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span>          <span class="fl">87.05341</span>         <span class="fl">9.226152</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">~~~</span>o<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~</span>casnet<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~</span>o<span class="sc">~</span><span class="er">~~</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Should be the same</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>rqa1<span class="sc">$</span>RR<span class="sc">==</span>rn1<span class="sc">$</span>graph_measures<span class="sc">$</span>EdgeDensity</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="cn">FALSE</span></span></code></pre></div>
<div class="section level4">
<h4 class="unnumbered" id="ts-2">TS 2<a class="anchor" aria-label="anchor" href="#ts-2"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#----------------------</span>
<span class="co"># Adjacency matrix TS_2</span>
<span class="co">#----------------------</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">series</span><span class="op">$</span><span class="va">TS_2</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Because these are generated signals, look for a drop in FNN below 1%.</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_parameters.html">est_parameters</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">series</span><span class="op">$</span><span class="va">TS_2</span>, nnThres <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">RN2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rn.html">rn</a></span><span class="op">(</span>y1 <span class="op">=</span> <span class="va">series</span><span class="op">$</span><span class="va">TS_2</span>, emDim <span class="op">=</span> <span class="va">p2</span><span class="op">$</span><span class="va">optimDim</span>, emLag <span class="op">=</span> <span class="va">p2</span><span class="op">$</span><span class="va">optimLag</span>, emRad <span class="op">=</span> <span class="cn">NA</span>,  targetValue <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="fu"><a href="../reference/rn_plot.html">rn_plot</a></span><span class="op">(</span><span class="va">RN2</span><span class="op">)</span>

<span class="co"># Get RQA measures</span>
<span class="va">rqa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rp_measures.html">rp_measures</a></span><span class="op">(</span><span class="va">RN2</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Create RN graph</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">RN2</span>, mode<span class="op">=</span><span class="st">"undirected"</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span>
<span class="va">g2r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_spiral_graph.html">make_spiral_graph</a></span><span class="op">(</span><span class="va">g2</span>, arcs <span class="op">=</span> <span class="va">arcs</span>, epochColours <span class="op">=</span> <span class="fu"><a href="../reference/getColours.html">getColours</a></span><span class="op">(</span><span class="va">arcs</span><span class="op">)</span>, markTimeBy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Get RN measures</span>
<span class="va">rn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rn_measures.html">rn_measures</a></span><span class="op">(</span><span class="va">g2</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Should be the same</span>
<span class="va">rqa2</span><span class="op">$</span><span class="va">RR</span><span class="op">==</span><span class="va">rn2</span><span class="op">$</span><span class="va">graph_measures</span><span class="op">$</span><span class="va">EdgeDensity</span></code></pre></div>
</div>
<div class="section level4">
<h4 class="unnumbered" id="ts-3">TS 3<a class="anchor" aria-label="anchor" href="#ts-3"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#----------------------</span>
<span class="co"># Adjacency matrix TS_3</span>
<span class="co">#----------------------</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">series</span><span class="op">$</span><span class="va">TS_3</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Because these are generated signals, look for a drop in FNN below 1%.</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_parameters.html">est_parameters</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">series</span><span class="op">$</span><span class="va">TS_3</span>, nnThres <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">RN3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rn.html">rn</a></span><span class="op">(</span>y1 <span class="op">=</span> <span class="va">series</span><span class="op">$</span><span class="va">TS_3</span>, emDim <span class="op">=</span> <span class="va">p3</span><span class="op">$</span><span class="va">optimDim</span>, emLag <span class="op">=</span> <span class="va">p3</span><span class="op">$</span><span class="va">optimLag</span>, emRad <span class="op">=</span> <span class="cn">NA</span>, targetValue <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="fu"><a href="../reference/rn_plot.html">rn_plot</a></span><span class="op">(</span><span class="va">RN3</span><span class="op">)</span>

<span class="co"># Get RQA measures</span>
<span class="va">rqa3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rp_measures.html">rp_measures</a></span><span class="op">(</span><span class="va">RN3</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Create RN graph</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">RN3</span>, mode<span class="op">=</span><span class="st">"undirected"</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span>
<span class="va">g3r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_spiral_graph.html">make_spiral_graph</a></span><span class="op">(</span><span class="va">g3</span>,arcs <span class="op">=</span> <span class="va">arcs</span> ,epochColours <span class="op">=</span> <span class="fu"><a href="../reference/getColours.html">getColours</a></span><span class="op">(</span><span class="va">arcs</span><span class="op">)</span>, markTimeBy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Get RN measures</span>
<span class="va">rn3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rn_measures.html">rn_measures</a></span><span class="op">(</span><span class="va">g3</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Should be the same</span>
<span class="va">rqa3</span><span class="op">$</span><span class="va">RR</span><span class="op">==</span><span class="va">rn3</span><span class="op">$</span><span class="va">graph_measures</span><span class="op">$</span><span class="va">EdgeDensity</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="multiplex-recurrence-networks">Multiplex Recurrence Networks<a class="anchor" aria-label="anchor" href="#multiplex-recurrence-networks"></a>
</h3>
<p>Consider the three time series to be part of a multi-layer recurrence
network. Common properties of the multiplex network are <em>inter-layer
mutual information</em> and <em>edge overlap</em> can be calculated
using function <code><a href="../reference/mrn.html">casnet::mrn()</a></code>. One problem, the networks
have to be all of the same size (same number of nodes, a multivariate
time series), but here we have reconstructed the phase space using
different embedding parameters… let’s choose one set of parameters for
all time series.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">emDim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">optimDim</span>,<span class="va">p2</span><span class="op">$</span><span class="va">optimDim</span>,<span class="va">p3</span><span class="op">$</span><span class="va">optimDim</span><span class="op">)</span><span class="op">)</span>
<span class="va">emLag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">optimLag</span>,<span class="va">p2</span><span class="op">$</span><span class="va">optimLag</span>,<span class="va">p3</span><span class="op">$</span><span class="va">optimLag</span><span class="op">)</span><span class="op">)</span>

<span class="va">RNs</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/llply.html" class="external-link">llply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="fu"><a href="../reference/rn.html">rn</a></span><span class="op">(</span>y1 <span class="op">=</span> <span class="va">series</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span>, emDim <span class="op">=</span> <span class="va">emDim</span>, emLag <span class="op">=</span> <span class="va">emLag</span>, emRad <span class="op">=</span> <span class="cn">NA</span>, targetValue <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
<span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/llply.html" class="external-link">llply</a></span><span class="op">(</span><span class="va">RNs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">r</span>, mode<span class="op">=</span><span class="st">"undirected"</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">layers</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g1"</span>,<span class="st">"g2"</span>,<span class="st">"g3"</span><span class="op">)</span>

<span class="fu"><a href="../reference/mrn.html">mrn</a></span><span class="op">(</span>layers <span class="op">=</span> <span class="va">layers</span><span class="op">)</span></code></pre></div>
<p>A variety of plots can be created using
<code><a href="../reference/mrn_plot.html">casnet::mrn_plot()</a></code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Simple</span>
<span class="fu"><a href="../reference/mrn_plot.html">mrn_plot</a></span><span class="op">(</span>layers <span class="op">=</span> <span class="va">layers</span>, showEdgeColourLegend <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/mrn_plot.html">mrn_plot</a></span><span class="op">(</span>layers <span class="op">=</span> <span class="va">layers</span>, MRNweightedBy <span class="op">=</span> <span class="st">"EdgeOverlap"</span>, showEdgeColourLegend <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>


<span class="co"># Include picture of Layers </span>
<span class="fu"><a href="../reference/mrn_plot.html">mrn_plot</a></span><span class="op">(</span>layers <span class="op">=</span> <span class="va">layers</span>, RNnodes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/mrn_plot.html">mrn_plot</a></span><span class="op">(</span>layers <span class="op">=</span> <span class="va">layers</span>, RNnodes <span class="op">=</span> <span class="cn">TRUE</span>,MRNweightedBy <span class="op">=</span> <span class="st">"EdgeOverlap"</span>, showEdgeColourLegend <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="time-varying-multiplex-recurrence-networks">Time-varying Multiplex Recurrence Networks<a class="anchor" aria-label="anchor" href="#time-varying-multiplex-recurrence-networks"></a>
</h3>
<p>The MRN can be calculated in a sliding window, by setting the
arguments <code>win</code> and <code>step</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># This will generate 26 windows</span>
<span class="va">MRN_win</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mrn.html">mrn</a></span><span class="op">(</span>layers <span class="op">=</span> <span class="va">layers</span>, win <span class="op">=</span> <span class="fl">250</span>, step <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="co"># The MRN are returned as a list</span>
<span class="va">MRN_win</span><span class="op">$</span><span class="va">interlayerMI</span>

<span class="co"># It may be informative to create an animation [not shown here because it displays in the Viewer]</span>
<span class="co"># MRN_ani &lt;- mrn_plot(layers = layers, win = 250, step = 10, createAnimation = TRUE)</span>

<span class="co"># The animation is stored in an output field, but is also saved as a .gif, see the man pages for more options.</span>
<span class="co"># MRN_ani$MRNanimationGG</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Fred Hasselman.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
