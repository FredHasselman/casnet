<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract Phases from weighted RN — rn_phases • casnet</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract Phases from weighted RN — rn_phases"><meta property="og:description" content="This function will extract phases (regions of attraction in phase space) based on a weighted RN object created with function rn.
The assumption is that coordinates in state space that are either close in terms of distance, or are re-visited with short recurrence times,
or with high-frequency, are regions of attraction for the system."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">casnet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/CRQA.html">Recurrence Quantification Analysis</a>
    </li>
    <li>
      <a href="../articles/dynamiccomplexity.html">Dynamic Complexity as an Early-Warning Indicator for Clinical Change</a>
    </li>
    <li>
      <a href="../articles/scalingphenomena.html">Quantifying Scaling Phenomena in Time Series</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/FredHasselman/casnet/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract Phases from weighted RN</h1>
    <small class="dont-index">Source: <a href="https://github.com/FredHasselman/casnet/blob/HEAD/R/rn.R" class="external-link"><code>R/rn.R</code></a></small>
    <div class="hidden name"><code>rn_phases.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function will extract phases (regions of attraction in phase space) based on a weighted <code>RN</code> object created with function <a href="rn.html">rn</a>.
The assumption is that coordinates in state space that are either close in terms of distance, or are re-visited with short recurrence times,
or with high-frequency, are regions of attraction for the system.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rn_phases</span><span class="op">(</span></span>
<span>  <span class="va">RN</span>,</span>
<span>  maxPhases <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  minStatesinPhase <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  maxStatesinPhase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NROW</a></span><span class="op">(</span><span class="va">RN</span><span class="op">)</span>,</span>
<span>  useDegree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  inverseWeight <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cleanUp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnCentroid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"mean.sd"</span>, <span class="st">"median.mad"</span>, <span class="st">"centroid"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  removeSingularities <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  standardise <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"mean.sd"</span>, <span class="st">"median.mad"</span>, <span class="st">"unit"</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  returnGraph <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  doPhaseProfilePlot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plotCentroid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  space_dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colOrder <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  phaseColours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  doSpiralPlot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  doPhaseSeriesPlot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  doPhaseSpacePojectionPlot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showEpochLegend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  epochColours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  epochLabel <span class="op">=</span> <span class="st">"Phase"</span>,</span>
<span>  excludeOther <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  excludeNorec <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-rn">RN<a class="anchor" aria-label="anchor" href="#arg-rn"></a></dt>
<dd><p>A matrix produced by the function <a href="rn.html">rn</a></p></dd>


<dt id="arg-maxphases">maxPhases<a class="anchor" aria-label="anchor" href="#arg-maxphases"></a></dt>
<dd><p>The maximum number of phases to extract. These will be the phases associated with the highest node degree or node strength. All other recurrent point will be labelled with "Other". If <code>NA</code>, the value will be set to <code>NROW(RN)</code>, this will return all the potential phases in the data irrespective of their frequency/strength of recurrence  (default = <code>5</code>)</p></dd>


<dt id="arg-minstatesinphase">minStatesinPhase<a class="anchor" aria-label="anchor" href="#arg-minstatesinphase"></a></dt>
<dd><p>A parameter applied after the extraction of phases (limited by <code>maxPhases</code>). If any extracted phases do not have a minimum number of <code>minStatesinPhase</code> + <code>1</code> (= the state that was selected based on node strength), the phase will be removed from the result (default = <code>1</code>)</p></dd>


<dt id="arg-maxstatesinphase">maxStatesinPhase<a class="anchor" aria-label="anchor" href="#arg-maxstatesinphase"></a></dt>
<dd><p>A parameter applied after the extraction of phases (limited by <code>maxPhases</code>). If any extracted phases exceeds a maximum number of <code>maxStatesinPhase</code> + <code>1</code> (= the state that was selected based on node strength), the phase will be removed from the result (default = <code>NROW(RN)</code>)</p></dd>


<dt id="arg-usedegree">useDegree<a class="anchor" aria-label="anchor" href="#arg-usedegree"></a></dt>
<dd><p>By default, node strength will be used to determine the phases. Set to <code>TRUE</code> to use the node degree (default = <code>FALSE</code>)</p></dd>


<dt id="arg-inverseweight">inverseWeight<a class="anchor" aria-label="anchor" href="#arg-inverseweight"></a></dt>
<dd><p>Whether to perform the operation <code>1/weight</code> on the edge weights. The default is <code>TRUE</code>, if the matrix was weighted by a distance metric (<code>weightedBy = "si"</code>) edges with smaller distances (recurring coordinates closer to the current coordinate) have greater impact on the node strength calculation used to select the phases. If the matrix was weighted by recurrence time (<code>weightedBy = "rt"</code>) and <code>inverseWeight = TRUE</code>, recurrent points with shorter recurrence times will have greater impact on the strength calculation. If <code>weightedBy = "rf"</code>, lower frequencies will end up having more impact. (default = <code>TRUE</code>)</p></dd>


<dt id="arg-cleanup">cleanUp<a class="anchor" aria-label="anchor" href="#arg-cleanup"></a></dt>
<dd><p>Try to assign states to phases that were not assigned by the algorithm. If <code>FALSE</code>, these states will be added to category "Other" (default = <code>TRUE</code>)</p></dd>


<dt id="arg-returncentroid">returnCentroid<a class="anchor" aria-label="anchor" href="#arg-returncentroid"></a></dt>
<dd><p>Values can be <code>"no"</code>, <code>"mean.sd"</code>, <code>"median.mad"</code>, <code>"centroid"</code>. Any other value than <code>"no"</code> will return a data frame with the central tendency and deviation measures for each phase (default = <code>"no"</code>)</p></dd>


<dt id="arg-removesingularities">removeSingularities<a class="anchor" aria-label="anchor" href="#arg-removesingularities"></a></dt>
<dd><p>Will remove states that recur only once (nodes with <code>degree(g) == 1</code>) (default = <code>FALSE</code>)</p></dd>


<dt id="arg-standardise">standardise<a class="anchor" aria-label="anchor" href="#arg-standardise"></a></dt>
<dd><p>Standardise the series using <code><a href="ts_standardise.html">ts_standardise()</a></code> with <code>adjustN = FALSE</code> (default = "mean.sd")</p></dd>


<dt id="arg-returngraph">returnGraph<a class="anchor" aria-label="anchor" href="#arg-returngraph"></a></dt>
<dd><p>Returns all the graph object objects of the plots that have been produced (default = <code>FALSE</code>)</p></dd>


<dt id="arg-dophaseprofileplot">doPhaseProfilePlot<a class="anchor" aria-label="anchor" href="#arg-dophaseprofileplot"></a></dt>
<dd><p>Produce a profile plot of the extracted phases (default = <code>TRUE</code>)</p></dd>


<dt id="arg-plotcentroid">plotCentroid<a class="anchor" aria-label="anchor" href="#arg-plotcentroid"></a></dt>
<dd><p>Plot the centroid requested in <code>returnCentroid</code>? (default = <code>FALSE</code>)</p></dd>


<dt id="arg-space-dims">space_dims<a class="anchor" aria-label="anchor" href="#arg-space-dims"></a></dt>
<dd><p>A vector of titles to use for the dimensions. If <code>NULL</code> the values will be read from the attribute of <code>RN</code>.</p></dd>


<dt id="arg-colorder">colOrder<a class="anchor" aria-label="anchor" href="#arg-colorder"></a></dt>
<dd><p>Should the order of the dimensions reflect the order of the columns in the dataset? If <code>FALSE</code> the order will be based on the values of the dimensions observed in the first extracted phase (default = <code>FALSE</code>)</p></dd>


<dt id="arg-phasecolours">phaseColours<a class="anchor" aria-label="anchor" href="#arg-phasecolours"></a></dt>
<dd><p>Colours for the different phases in the phase plot. If <code>epochColours</code> also has a value, <code>phaseColours</code> will be used instead (default = <code>NULL</code>)</p></dd>


<dt id="arg-dospiralplot">doSpiralPlot<a class="anchor" aria-label="anchor" href="#arg-dospiralplot"></a></dt>
<dd><p>Produce a plot of the recurrence network with the nodes coloured by phases (default = <code>FALSE</code>)</p></dd>


<dt id="arg-dophaseseriesplot">doPhaseSeriesPlot<a class="anchor" aria-label="anchor" href="#arg-dophaseseriesplot"></a></dt>
<dd><p>Produce a time series of the phases as they occur with a marginal histogram of their frequency (default = <code>FALSE</code>)</p></dd>


<dt id="arg-showepochlegend">showEpochLegend<a class="anchor" aria-label="anchor" href="#arg-showepochlegend"></a></dt>
<dd><p>Should a legend be shown for the epoch colours? (default = <code>TRUE</code>)</p></dd>


<dt id="arg-epochcolours">epochColours<a class="anchor" aria-label="anchor" href="#arg-epochcolours"></a></dt>
<dd><p>A vector of length <code>vcount(g)</code> with colour codes (default = <code>NULL</code>)</p></dd>


<dt id="arg-epochlabel">epochLabel<a class="anchor" aria-label="anchor" href="#arg-epochlabel"></a></dt>
<dd><p>A title for the epoch legend (default = <code>"Epoch"</code>)</p></dd>


<dt id="arg-excludeother">excludeOther<a class="anchor" aria-label="anchor" href="#arg-excludeother"></a></dt>
<dd><p>Should the phase "Other" be excluded from plots? (default = <code>FALSE</code>)</p></dd>


<dt id="arg-excludenorec">excludeNorec<a class="anchor" aria-label="anchor" href="#arg-excludenorec"></a></dt>
<dd><p>Should the category "No recurrence" be excluded from plots? (default = <code>TRUE</code>)</p></dd>


<dt id="arg-dophasespaceprojectionplot">doPhaseSpaceProjectionPlot<a class="anchor" aria-label="anchor" href="#arg-dophasespaceprojectionplot"></a></dt>
<dd><p>produce a 2D <code>umap</code> projection of the phases (default = <code>FALSE</code>)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame with information about the phases or a list object with data and graph objects (if requested).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The method used for the identification of phases is on the properties of the <code>RN</code> object:</p><ul><li><p>If weighted by distance <code>"si"</code>, the inverse distance will be used, which means higher weights correspond to closer states.</p></li>
<li><p>If weighted by recurrence time <code>"rt"</code>, the inverse time will be used, which means higher weights correspond to faster recurrence times.</p></li>
</ul><p>The procedure is as follows:</p><ol><li><p>Identify the node with the highest strength</p></li>
<li><p>Identify the nodes that connect to this node</p></li>
<li><p>Identify the node with highest strength that does not connect to the node identified in step 1.</p></li>
<li><p>Repeat until criteria set in <code>maxPhases</code>, <code>minStatesinPhase</code> and <code>maxStatesinPhase</code> are triggered.</p></li>
<li><p>Clean up. If <code>cleanUp = TRUE</code> the remaining states that connect to nodes of one of the identified phases, but not to the node with highest strength identified in step 1 will be added to that phase. Otherwise these nodes will end up in category "Other".</p></li>
</ol></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other Distance matrix operations (recurrence network):
<code><a href="mat_di2bi.html">mat_di2bi</a>()</code>,
<code><a href="mat_di2ch.html">mat_di2ch</a>()</code>,
<code><a href="mat_di2we.html">mat_di2we</a>()</code>,
<code><a href="rn.html">rn</a>()</code>,
<code><a href="rn_plot.html">rn_plot</a>()</code>,
<code><a href="rn_recSpec.html">rn_recSpec</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the ManyAnalysts dataset to create a phase plot with default settings</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"manyAnalystsESM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">manyAnalystsESM</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">RN</span> <span class="op">&lt;-</span> <span class="fu"><a href="rn.html">rn</a></span><span class="op">(</span>y1 <span class="op">=</span> <span class="va">df</span>, doEmbed <span class="op">=</span> <span class="cn">FALSE</span>, weighted <span class="op">=</span> <span class="cn">TRUE</span>, weightedBy <span class="op">=</span> <span class="st">"si"</span>, emRad <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This returns 6 phases which have minimally 1 state</span></span></span>
<span class="r-in"><span><span class="fu">rn_phases</span><span class="op">(</span><span class="va">RN</span>, maxPhases <span class="op">=</span> <span class="fl">10</span>, doPhaseProfilePlot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rn_phases-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use min. number of states as the extraction criterion</span></span></span>
<span class="r-in"><span><span class="fu">rn_phases</span><span class="op">(</span><span class="va">RN</span>, maxPhases <span class="op">=</span> <span class="cn">NA</span>, minStatesinPhase <span class="op">=</span> <span class="fl">7</span>, doPhaseProfilePlot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rn_phases-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Fred Hasselman.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

